{
    "Slug": "advancing-azure-virtual-machine-availability-monitoring-with-project-flash",
    "Title": "Advancing Azure Virtual Machine availability monitoring with Project Flash",
    "Summary": "Today, we’re excited to announce the completion of the project’s first two milestones—the preview of VM availability data in Azure Resource Graph, and the private preview of a VM availability metric in Azure Monitor.",
    "Content": "<p>&ldquo;<em>As we head into the fourth calendar year of the <a href=\"https://www.aka.ms/AdvancingReliability\" target=\"_blank\">Advancing Reliability blog series</a>, empowering organizations to run their workloads reliably on Azure remains one of our top priorities. We continually invest in evolving the Azure platform to help achieve this on a daily basis. Your ability to monitor virtual machine (VM) availability in a robust and comprehensive way is paramount to ensuring that your applications are available and resilient. For today&rsquo;s post in the series, I have asked Program Manager, <strong>Pujitha Desiraju</strong>, from our Azure Core Platform Fundamentals Engineering team to talk about the latest observability enhancements for VM availability monitoring, as well as planned investments to deliver the best monitoring experience</em>.&rdquo;&mdash;Mark Russinovich, CTO, Azure</p>\n\n<hr>\n<p>&nbsp;</p>\n\n<p><em>This post was co-authored by Principal Software Engineering Manager, <strong>Gaurav Jagtiani</strong>.</em></p>\n\n<p>Flash, as the project is internally known, is a collection of efforts across Azure Engineering, that aims to evolve Azure&rsquo;s virtual machine (VM) availability monitoring ecosystem into a centralized, holistic, and intelligible solution customers can rely on to meet their specific observability needs. Today, we&rsquo;re excited to announce the completion of the project&rsquo;s first two milestones&mdash;the preview of VM availability data in <a href=\"https://azure.microsoft.com/features/resource-graph/\">Azure Resource Graph</a>, and the private preview of a VM availability metric in <a href=\"https://azure.microsoft.com/en-us/services/monitor/\">Azure Monitor</a>.</p>\n\n<h2>What is Project Flash?</h2>\n\n<p>Project Flash derives its name from our commitment to building robust and rapid ways to monitor virtual machine (VM) availability as comprehensively as possible&mdash;a key prerequisite for efficient application performance. It&rsquo;s our mission to ensure you can:</p>\n\n<ul>\n\t<li><strong>Consume accurate and actionable data</strong> on VM availability disruptions (for example, VM reboots and restarts, application freezes due to network driver updates, and 30-second host OS updates), along with precise failure details (for example, platform versus user-initiated, reboot versus freeze, planned versus unplanned).</li>\n\t<li><strong>Analyze and alert on trends in VM availability</strong> for quick debugging and month-over-month reporting.</li>\n\t<li><strong>Periodically monitor data at scale</strong> and build custom dashboards to stay updated on the latest availability states of all resources.</li>\n\t<li><strong>Receive automated root cause analyses (RCAs)</strong> detailing impacted VMs, downtime cause and duration, consequent fixes, and similar&mdash;all to enable targeted investigations and post-mortem analyses.</li>\n\t<li><strong>Receive instantaneous notifications</strong> on critical changes in VM availability to quickly trigger remediation actions and prevent end-user impact.</li>\n\t<li><strong>Dynamically tailor and automate platform recovery policies</strong>, based on ever-changing workload sensitivities and failover needs.</li>\n</ul>\n\n<p>With these goals in mind, we&rsquo;ve divided our execution strategy into two phases&mdash;a near-term phase to meet critical current needs, and a long-term phase to deliver the best VM availability monitoring experience. This two-phased approach helps us continually bridge gaps, iterate on service quality, and learn from your feedback at every step along the way.</p>\n\n<h2>Announcing new monitoring options</h2>\n\n<p>For the first phase, we are providing different options to enable convenient access to VM availability data to address a range of observability needs. We aim to maintain data consistency with similar rigorous quality standards across all of these existing features and solutions, like <a href=\"https://docs.microsoft.com/en-us/azure/service-health/resource-health-overview\" target=\"_blank\">Resource Health</a> or <a href=\"https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log\" target=\"_blank\">Activity Log</a>, to deliver a consistent view agnostic of the solution you choose.</p>\n\n<h3>Introducing at-scale analysis for VM availability</h3>\n\n<p>Today, we&rsquo;re excited to reach our first Project Flash milestone&mdash;with the preview release of VM availability states in Azure Resource Graph for at-scale programmatic consumption.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/azure/governance/resource-graph/overview\" target=\"_blank\">Azure Resource Graph</a> is a service in Azure that is extensively adopted for its efficient ability to query across many subscriptions, all at once and at low latencies. We&rsquo;re currently emitting <a href=\"https://docs.microsoft.com/en-us/azure/service-health/resource-health-overview#health-status\" target=\"_blank\">VM availability states</a> (Available, Unavailable, and Unknown) to the Health Resources table in Azure Resource Graph, so you can perform complex <a href=\"https://docs.microsoft.com/en-us/azure/data-explorer/data-explorer-overview\" target=\"_blank\">Kusto Query Language (KQL) queries</a> for sieving through large datasets at once. This functionality is handy for tracking historical changes in VM availability, for building custom dashboards, and for performing detailed investigations across numerous resource properties spread across multiple tables.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f4377708-8c04-45d9-835d-d5c503b8db87.png\"><img alt=\"Azure Resource Graph Explorer Window with query and results, to demonstrate fetching data from the HealthResources table.\" border=\"0\" height=\"449\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/550dc050-72b4-40b0-a5e5-df5af79f169c.png\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"Figure 1 ARG Explorer Window\" width=\"1024\"></a></p>\n\n<p><em><strong>Figure 1:</strong> Azure Resource Graph Explorer Window with query and results, to demonstrate fetching data from the HealthResources table.</em></p>\n\n<ol>\n</ol>\n\n<p>We are planning to add failure details and degraded VM scenarios to the Health Resources table in Azure Resource Graph, later this year. These details will ensure you are properly informed on the cause and impact of any failures&mdash;so you can either failover, reboot in place, or take the appropriate mitigations to prevent end-user impact.</p>\n\n<p>Navigate to <a href=\"https://ms.portal.azure.com/#blade/HubsExtension/ArgQueryBlade/resourceType/Microsoft.Resources%2Fresources\" target=\"_blank\">Azure Resource Graph Explorer</a> on the Azure portal to get started with any of the KQL queries <a href=\"https://docs.microsoft.com/en-us/azure/governance/resource-graph/samples/samples-by-table?tabs=azure-cli#healthresources\" target=\"_blank\">published for the Health Resources table</a>.</p>\n\n<h3>Introducing VM availability metric in Azure Monitor</h3>\n\n<p>We&rsquo;re also pleased to announce the private preview of an out-of-box VM availability metric in Azure Monitor, for a curated metric alerting and monitoring experience.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/data-platform-metrics\" target=\"_blank\">Metrics in Azure Monitor</a> are great for monitoring and analyzing time series representations of VM availability for quick and easy debugging, receiving scoped alerts on concerning trends, catching early indicators of degraded availability, correlating with other platform metrics, and more.</p>\n\n<p>The metric allows you to track the pulse of your VMs&mdash;during expected behavior, the metric displays a value of 1. In response to any VM availability disruptions, the metric dips to a 0 for the duration of impact. In case of an Azure infrastructure outage, we will emit nulls represented as a dotted line on the portal.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/682a713e-22d0-4f16-8c2a-637804d289ae.png\"><img alt=\"Screenshot of VM availability metric as seen on Metrics Explorer in the Azure portal, with occasional dips to reflect VM availability disruptions.\" border=\"0\" height=\"445\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6800f334-da66-4a18-8b2a-2a10a6b1345a.png\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"Screenshot of VM availability metric\" width=\"1024\"></a></p>\n\n<p><em><strong>Figure 2:</strong> Screenshot of VM availability metric as seen on Metrics Explorer in the Azure portal, with occasional dips to reflect VM availability disruptions.</em></p>\n\n<p>We released the private preview of the metric as phase one of our rollout plan, and are currently collecting customer feedback, to further improve our offering. We are planning to add failure details such as metric dimensions and platform logs next year, to allow you to precisely alert on failure scenarios that are impactful.</p>\n\n<h2>Coming soon</h2>\n\n<p>The two monitoring options introduced above are just the beginning for Project Flash! We will continue to build upon our existing solutions by improving data quality and failure attribution. In parallel, we are designing two new monitoring offerings to meet your latency and mitigation needs, while also investing heavily in the underlying platform to make our fault detection more resilient and comprehensive.</p>\n\n<h3>Azure Event Grid for instantaneous notifications</h3>\n\n<p>Successfully running business-critical applications requires hyper-awareness of any VM availability impacting event, so remediation actions can be triggered instantaneously to prevent end-user impact. To support you in your daily operations, we are planning to design a notification mechanism that leverages the low-latency technology of <a href=\"https://docs.microsoft.com/en-us/azure/event-grid/overview\" target=\"_blank\">Azure Event Grid</a>. This will allow you to simply subscribe to an <a href=\"https://docs.microsoft.com/en-us/azure/event-grid/system-topics\" target=\"_blank\">Event Grid system topic</a>, and route scoped events via <a href=\"https://docs.microsoft.com/en-us/azure/event-grid/event-handlers\" target=\"_blank\">event handlers</a> to any downstream tooling, instantaneously.</p>\n\n<h3>Automate and tailor platform recovery policies</h3>\n\n<p>Considering the numerous ongoing investments to improve your VM availability monitoring experience, Project Flash intends to empower you even further by providing you knobs to customize recovery policies triggered by the platform, in response to cases of VM availability disruptions.</p>\n\n<p>One such knob we are designing is the ability to opt-out of <a href=\"https://azure.microsoft.com/en-us/blog/service-healing-auto-recovery-of-virtual-machines/\" target=\"_blank\">Service Healing</a> for single-instance VMs, in response to a specific set of unanticipated Availability disruptions. This knob will be made available via the portal or at the time of VM deployment and can be updated dynamically. Note that leveraging this feature will render the usual Azure Virtual Machine availability SLAs ineffective.</p>\n\n<p align=\"left\">In the future, we will explore introducing knobs to also opt-out of other applicable recovery policies (for example, <a href=\"https://azure.microsoft.com/en-us/blog/improving-azure-virtual-machine-resiliency-with-predictive-ml-and-live-migration/\" target=\"_blank\">Live Migration</a> or <a href=\"https://azure.microsoft.com/en-us/blog/improving-azure-virtual-machines-resiliency-with-project-tardigrade/\" target=\"_blank\">Tardigrade</a>), to ensure you can easily adapt to your ever-changing mitigation needs.</p>\n\n<h3>Ongoing platform quality investments</h3>\n\n<p>While the first phase is designed to meet your current observability needs, we remain focused on our long-term goal of delivering a world-class observability experience surrounding VM availability. We are extremely excited for all the data enrichments and technology advancements that will contribute to this experience, so here&rsquo;s an early look at our roadmap of planned investments:</p>\n\n<ol>\n\t<li><strong>Fault detection and attribution:</strong> We are continuously evolving our underlying infrastructure to detect and attribute failures both precisely and instantaneously&mdash;so that we can reduce unknown or missing health status reports, emit actionable failure details, and handle platform recovery customizations. This remains our top investment area on which we continue to iterate every cycle.</li>\n\t<li><strong>Root cause analysis (RCA) automation:</strong> We are planning to implement easy tracking mechanisms for every unique VM downtime, along with automatic construction and emission of detailed downtime RCA statements to reduce manual tracking and churn on your end.</li>\n\t<li><strong>AIOps integration:</strong> We are looking to leverage the tremendous <a href=\"https://azure.microsoft.com/en-us/blog/advancing-azure-service-quality-with-artificial-intelligence-aiops/\" target=\"_blank\">advancements being made in AIOps</a> across Microsoft, for enabling smart insights and anomaly detection and diagnosis across the multitude of data points on VM Availability.</li>\n\t<li><strong>Centralized and cohesive user experience:</strong> We acknowledge that a consequence of our near-term approach is that across our different services we have multiple monitoring, alerting, and recovery tools which may lead to a confusing and disparate experience for you. This is a problem we intend to solve with our final phase. Our north star goal is to provide end-users access to distinct and necessary representations of VM availability, consolidated within <a href=\"https://azure.microsoft.com/en-us/services/monitor/\" target=\"_blank\">Azure Monitor</a>, and categorized according to common usage patterns for discoverability, ease of use and intuitive onboarding.</li>\n</ol>\n\n<h2>Learn more</h2>\n\n<p>This list is certainly not exhaustive as we have multiple enrichments planned as part of our long-term strategy. To reiterate, our intention with Project Flash is to make VM availability monitoring extremely intuitive, comprehensive, and seamless&mdash;so you are always prepared for and informed about any changes in the health of your workloads, ultimately to maintain your own SLAs and business promises.</p>\n\n<p>We will continue to share updates on Project Flash through blogs like this, to ensure you stay up to date on the latest. Stay tuned!</p>\n"
}