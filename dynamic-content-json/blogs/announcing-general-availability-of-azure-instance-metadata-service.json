{
    "Slug": "announcing-general-availability-of-azure-instance-metadata-service",
    "Title": "Announcing General Availability of Instance Metadata Service in Global Azure Regions",
    "Summary": "We are excited to announce the general Availability of Azure Instance Metadata Service in all Global Azure regions. Azure Instance Metadata Service is a RESTful endpoint that allows virtual machines instances to get information regarding its compute, network and upcoming maintenance events.",
    "Content": "<p>We are excited to announce General Availability of Instance Metadata Service in <strong>all Global Azure </strong>regions and <strong>Public preview</strong> in German/Government and China cloud. Instance Metadata Service is a RESTful endpoint that allows virtual machines instances to get information regarding its compute, network and <a href=\"https://aka.ms/scheduledevents\">upcoming maintenance events</a>. The endpoint is available at a well-known non-routable IP address (169.254.169.254) that can be accessed only from within the VM. The data from Instance Metadata Service can help with your <a href=\"https://aka.ms/azureimds\">cluster setup, replica placement, supportability, telemetry</a>, or other cluster bootstrap or runtime needs.</p>\n\n<h2>Service Availability</h2>\n\n<p>Service is available to all Azure Resource Manager created VMs in <strong>all Global Azure </strong>regions. The service is also now available in preview in Government/China/German Azure Clouds.</p>\n\n<h2>Detailed documentation</h2>\n\n<p>Learn more about <a href=\"https://aka.ms/azureimds\">Azure Instance Metadata Service</a></p>\n\n<h2>Retrieving instance metadata</h2>\n\n<p>Instance Metadata Service is available for running VMs created/managed using <a href=\"https://docs.microsoft.com/en-us/rest/api/resources/?redirectedfrom=MSDN\">Azure Resource Manager</a>. To access all data categories for an instance, use the following sample code for Linux or Windows</p>\n\n<h3>Linux</h3>\n\n<p><code>curl -H Metadata:true <a href=\"\"></a></code></p>\n\n<h3>Windows</h3>\n\n<p><code>curl &ndash;H @{&lsquo;Metadata&rsquo;=&rsquo;true&rsquo;} <a href=\"\"></a></code></p>\n\n<p>The default output for all instance metadata is of json format (content type Application/JSON)</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/b71a0b83-c4e6-41c9-98fb-e828a6472d22.gif\"><img alt=\"Azure Instance Metadata Service\" height=\"734\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d264d9e2-d2bc-4505-89fb-f4cd5f8b80d7.gif\" style=\"display: inline;\" title=\"Azure Instance Metadata Service\" width=\"1175\"></a></p>\n\n<h2>Instance Metadata data categories</h2>\n\n<p>Following table has a list of all data categories available via Instance Metadata</p>\n\n<table border=\"0\" cellpadding=\"2\" cellspacing=\"0\" width=\"901\">\n <tbody>\n  <tr>\n   <td valign=\"top\" width=\"290\">Data</td>\n   <td valign=\"top\" width=\"609\">Description</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">\n   <p>location</p>\n   </td>\n   <td valign=\"top\" width=\"609\">\n   <p>Azure Region the VM is running</p>\n   </td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">name</td>\n   <td valign=\"top\" width=\"609\">Name of the VM</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">offer</td>\n   <td valign=\"top\" width=\"609\">Offer information for the VM image, these values are present only for images deployed from Azure image gallery</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">publisher</td>\n   <td valign=\"top\" width=\"609\">Publisher of the VM image</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">sku</td>\n   <td valign=\"top\" width=\"609\">Specific SKU for the VM image</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">version</td>\n   <td valign=\"top\" width=\"609\">Version of the VM Image</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">osType</td>\n   <td valign=\"top\" width=\"609\">Linux or Windows</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">platformUpdateDomain</td>\n   <td valign=\"top\" width=\"609\">Update domain the VM is running in.</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">platformFaultDomain</td>\n   <td valign=\"top\" width=\"609\">Fault domain the VM is running in.</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">vmId</td>\n   <td valign=\"top\" width=\"609\">Unique identifier for the VM, more info <a href=\"https://aka.ms/azureimds\">here</a></td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">vmSize</td>\n   <td valign=\"top\" width=\"609\">VM size</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">ipv4/privateIpAddress</td>\n   <td valign=\"top\" width=\"609\">Local IP address of the VM</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">ipv4/publicIpAddress</td>\n   <td valign=\"top\" width=\"609\">Public IP address for the Instance</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">subnet/address</td>\n   <td valign=\"top\" width=\"609\">Address for subnet</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">subnet/prefix</td>\n   <td valign=\"top\" width=\"609\">Subnet prefix , example 24</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">ipv6/ipaddress</td>\n   <td valign=\"top\" width=\"609\">IPv6 address for the VM</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">macAddress</td>\n   <td valign=\"top\" width=\"609\">VM mac address</td>\n  </tr>\n  <tr>\n   <td valign=\"top\" width=\"290\">scheduledevents</td>\n   <td valign=\"top\" width=\"609\">see <a href=\"https://aka.ms/scheduledevents\">scheduledevents</a>&nbsp;<strong>(In Preview)</strong></td>\n  </tr>\n </tbody>\n</table>\n\n<p>&nbsp;</p>\n\n<h2>FAQs</h2>\n\n<p>&nbsp;</p>\n\n<ul>\n <li>I am getting Bad request, Required metadata header not specified. What does this mean?\n <p>Metadata Service requires header of Metadata:true to be passed in the request. Passing header will allow access</p>\n </li>\n <li>Why&nbsp; am I not getting compute information for my VM?\n <p>Currently Instance Metadata Service supports Azure Resource Manager created instances only, in future we will add support for Cloud Services (Classic) VMs</p>\n </li>\n <li>I created my Virtual Machine through ARM a while back, Why am I not seeing compute metadata information?\n <p>For any VMs created after Sep 2016 you can simply add a new <a href=\"https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-using-tags\">Tag</a> to start seeing compute metadata. For older VMs (created before Sep 2016) you would have to add/remove <a href=\"https://docs.microsoft.com/en-us/azure/virtual-machines/windows/classic/manage-extensions\">extensions</a> to the VM to refresh metadata</p>\n </li>\n <li>Why am I getting error 500 - Internal server error?</li>\n</ul>\n\n<p>&nbsp; &nbsp;&nbsp; Please retry your request based on exponential back off system. If the issue persists contact Azure support.</p>\n\n<ul>\n <li>Where do I share Additional questions/comments?\n <p>Send your comments on <a href=\"https://feedback.azure.com\">https://feedback.azure.com</a></p>\n </li>\n</ul>\n"
}