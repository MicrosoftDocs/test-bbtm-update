{
    "Slug": "advancing-service-resilience-in-azure-active-directory-with-its-backup-authentication-service",
    "Title": "Advancing service resilience in Azure Active Directory with its backup authentication service",
    "Summary": "The most critical promise of our identity services is ensuring that every user can access the apps and services they need without interruption. We’ve been strengthening this promise to you through a multi-layered approach, leading to our improved promise of 99.99 percent authentication uptime for Azure Active Directory (Azure AD).",
    "Content": "<p><em>&ldquo;Continuing our <a href=\"https://www.aka.ms/AdvancingReliability\" target=\"_blank\">Advancing Reliability blog series</a>, which highlights key updates and initiatives related to improving the reliability of the Azure platform and services, today we turn our focus to Azure Active Directory (Azure AD). We laid out the core availability principles of Azure AD as part of this series <a href=\"https://azure.microsoft.com/blog/advancing-azure-active-directory-availability/\" target=\"_blank\">back in 2019</a> so I&rsquo;ve asked <strong>Nadim Abdo</strong>, Corporate Vice President, Engineering, to provide the latest update on how our engineering teams are working to ensure the reliability of our identity and access management services that are so critical to customers and partners.&rdquo;&mdash;</em>Mark Russinovich, CTO, Azure</p>\n\n<hr>\n<p>&nbsp;</p>\n\n<p>The most critical promise of our identity services is ensuring that every user can access the apps and services they need without interruption. We&rsquo;ve been strengthening this promise to you through a <a href=\"https://azure.microsoft.com/en-us/blog/advancing-azure-active-directory-availability/\" target=\"_blank\">multi-layered approach</a>, leading to our improved promise of <a href=\"https://techcommunity.microsoft.com/t5/azure-active-directory-identity/99-99-uptime-for-azure-active-directory/ba-p/1999628\" target=\"_blank\">99.99 percent authentication uptime</a> for <a href=\"https://azure.microsoft.com/en-us/services/active-directory/\" target=\"_blank\">Azure Active Directory (Azure AD)</a>. Today, I am excited to share a deep dive into generally available technology that allows Azure AD to achieve even higher levels of resiliency.</p>\n\n<p>The Azure AD backup authentication service transparently and automatically handles authentications for supported workloads when the primary Azure AD service is unavailable. It adds an additional layer of resilience on top of the multiple levels of redundancy in Azure AD. You can think of it as a backup generator or uninterrupted power supply designed to provide additional fault tolerance while staying completely transparent and automatic to you. This system operates in the Microsoft cloud but on separate and decorrelated systems and network paths from the primary Azure AD system. This means that it can continue to operate in case of service, network, or capacity issues across many Azure AD and dependent Azure services.</p>\n\n<h2>What workloads are covered by the service?</h2>\n\n<p>This service has been protecting Outlook Web Access and SharePoint Online workloads since 2019. Earlier this year we completed backup support for applications running on desktops and mobile devices, or &ldquo;native&rdquo; apps. All Microsoft native apps including Office 365 and Teams, plus non-Microsoft and customer-owned applications running natively on devices are now covered. No special action or configuration changes are required to receive the backup authentication coverage.</p>\n\n<p>Starting at the end of 2021, we will begin rolling out support for more web-based applications. We will be phasing in apps using Open ID Connect, starting with Microsoft web apps like Teams Online and Office 365, followed by customer-owned web apps that use Open ID Connect and Security Assertion Markup Language (SAML).</p>\n\n<h2>How does the service work?</h2>\n\n<p>When a failure of the Azure AD primary service is detected, the backup authentication service automatically engages, allowing the user&rsquo;s applications to keep working. As the primary service recovers, authentication requests are re-routed back to the primary Azure AD service. The backup authentication service operates in two modes:</p>\n\n<ul>\n\t<li><strong>Normal mode:</strong> The backup service stores essential authentication data during normal operating conditions. Successful authentication responses from Azure AD to dependent apps generate session-specific data that is securely stored by the backup service for up to three days. The authentication data is specific to a device-user-app-resource combination and represents a snapshot of a successful authentication at a point in time.</li>\n\t<li><strong>Outage mode:</strong> Any time an authentication request fails unexpectedly, the Azure AD gateway automatically routes it to the backup service. It then authenticates the request, verifies artifacts presented are valid (such as, refresh token, and session cookie), and looks for a strict session match in the previously stored data. An authentication response, consistent with what the primary Azure AD system would have generated, is then sent to the application. Upon recovery, traffic is dynamically re-routed back to the primary Azure AD service.</li>\n</ul>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2c142258-7521-4a61-9372-3c27330c4a28.png\"><img alt=\"Diagram showing clients/services like Outlook and Exchange Online accessing tokens – including cached access tokens from the new Backup Auth service\" border=\"0\" height=\"529\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a800fc14-3405-4bee-9558-f755641ef621.png\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"Token Access flow chart\" width=\"1024\"></a></p>\n\n<p>Routing to the backup service is automatic and its authentication responses are consistent with those usually coming from the primary Azure AD service. This means that the protection kicks in with no need for application modifications, nor manual intervention.</p>\n\n<p>Note that the priority of the backup authentication service is to keep user productivity alive for access to an app or resource where authentication was recently granted. This happens to be most of the type of requests to Azure AD&mdash;93 percent, in fact. &ldquo;New&rdquo; authentications beyond the three-day storage window, where access was not recently granted on the user&rsquo;s current device, are not currently supported during outages, but most users access their most important applications daily from a consistent device.</p>\n\n<h2>How are security policies and access compliance enforced during an outage?</h2>\n\n<p>The backup authentication service continuously monitors security events which affect user access to keep accounts secure, even if these events are detected right before an outage. It uses <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/concept-continuous-access-evaluation\" target=\"_blank\">Continuous Access Evaluation</a> to ensure the sessions that are no longer valid are revoked immediately. Examples of security events that would cause the backup service to restrict access during an outage include changes to device state, account disablement, account deletion, access being revoked by an admin, or detection of a high user risk event. Only once the primary authentication service has been restored would a user with a security event be able to regain access.</p>\n\n<p>In addition, the backup authentication service enforces Conditional Access policies. Policies are re-evaluated by the backup service before granting access during an outage to determine which policies apply and whether the required controls for applicable policies like multi-factor authentication (MFA) have been satisfied. If an authentication request is received by the backup service and a control like MFA has not been satisfied, then that authentication would be blocked.</p>\n\n<p>Conditional Access policies that rely on conditions such as user, application, device platform, and IP address are enforced using real-time data as detected by the backup authentication service. However, certain policy conditions (such as sign-in risk and role membership) cannot be evaluated in real-time, and are evaluated based on resilience settings. Resilience defaults enable Azure AD to safely maximize productivity when a condition (such as group membership) is not available in real-time during an outage. The service will evaluate a policy assuming that the condition has not changed since the latest access just before the outage.</p>\n\n<p>While we highly recommend customers to keep resilience defaults enabled, there may be some scenarios where admins would rather block access during an outage when a Conditional Access condition cannot be evaluated in real-time. For these rare cases, administrators can <a href=\"https://aka.ms/resiliencedefaultsdocs\" target=\"_blank\">disable resilience defaults</a> per policy within Conditional Access. If resilience defaults are disabled by policy, the backup authentication service will not serve requests that are subject to real-time policy conditions, meaning those users may be blocked by a primary Azure AD outage.</p>\n\n<h2>What is next?</h2>\n\n<p>The <a href=\"https://azure.microsoft.com/en-us/services/active-directory/\" target=\"_blank\">Azure AD</a> backup authentication service helps users stay productive in the unlikely scenario of an Azure AD primary authentication outage. The service provides another transparent layer of redundancy to our service in a decorrelated Microsoft cloud and network pathways. In the future, we will continue to expand protocol support, scenario support, and coverage beyond public clouds and we will expand the visibility of the service for our advanced customers.</p>\n\n<p>Thank you for your ongoing trust and partnership.</p>\n"
}